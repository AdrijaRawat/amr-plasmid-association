) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1)
)
# Set working directory
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")
# Load library
library(tidyverse)
# Load plasmid data
plasmids <- read_tsv(
"plasmids.tsv",
col_names = c("Genome", "Plasmid")
)
# Count plasmid frequencies
plasmid_count <- plasmids %>%
count(Plasmid) %>%
arrange(n)
# Clean dot plot (no overlap)
ggplot(plasmid_count,
aes(x = n, y = reorder(Plasmid, n))) +
geom_point(
size = 4,
color = "black"
) +
labs(
title = "Frequency of Plasmid Replicons",
x = "Number of Genomes Carrying Replicon",
y = "Plasmid Replicon Type"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold"),
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank()
)
ggplot(amr_count,
aes(x = n, y = reorder(Genome_ID, n))) +
geom_point(size = 4, color = "steelblue") +
geom_segment(aes(x = 0, xend = n, yend = Genome_ID),
color = "grey70") +
labs(
title = "AMR Gene Burden Across Klebsiella pneumoniae Genomes",
x = "Number of Resistance Genes",
y = "Genome"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold"),
axis.text.y = element_text(size = 10)
)
# AMR Gene Burden per Genome
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")
library(tidyverse)
#  Read AMR gene data
amr <- read_tsv(
"amr_genes.tsv",
col_names = c("Genome", "Gene")
)
#  Count AMR genes per genome
amr_count <- amr %>%
count(Genome)
#  Clean genome labels for plotting
amr_count <- amr_count %>%
mutate(
Genome_ID = basename(Genome),
Genome_ID = sub("_genomic.fna$", "", Genome_ID)
)
#  dot plot
ggplot(amr_count,
aes(x = n, y = reorder(Genome_ID, n))) +
geom_segment(
aes(x = 0, xend = n, yend = Genome_ID),
color = "grey70"
) +
geom_point(size = 4, color = "steelblue") +
labs(
title = "AMR Gene Burden Across Klebsiella pneumoniae Genomes",
x = "Number of Resistance Genes",
y = "Genome"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold"),
axis.text.y = element_text(size = 10),
panel.grid.minor = element_blank()
)
# set working directory
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")
library(tidyverse)
# load gene–plasmid data
pairs <- read_tsv(
"gene_plasmid_pairs.tsv",
col_names = c("Genome", "Gene", "Plasmid")
)
# count co-occurrences
heatmap_data <- pairs %>%
count(Gene, Plasmid) %>%
filter(n >= 2)
# plot heatmap
ggplot(heatmap_data, aes(Plasmid, Gene, fill = n)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "firebrick") +
labs(
title = "Plasmid–AMR Gene Co-occurrence",
x = "Plasmid replicon",
y = "Resistance gene",
fill = "Count"
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid = element_blank()
)
# set working directory
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")
library(tidyverse)
pairs <- read_tsv(
"gene_plasmid_pairs.tsv",
col_names = c("Genome", "Gene", "Plasmid")
)
heatmap_data <- pairs %>%
count(Gene, Plasmid) %>%
filter(n >= 2)
ggplot(heatmap_data, aes(Plasmid, Gene, fill = n)) +
geom_tile(color = "white") +
scale_fill_gradient(
low = "grey90",
high = "firebrick",
name = "Co-occurrence\n(count)"
) +
labs(
title = "Plasmid–AMR Gene Co-occurrence",
x = "Plasmid replicon",
y = "Resistance gene"
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid = element_blank()
)
# set working directory
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")
library(tidyverse)
pairs <- read_tsv(
"gene_plasmid_pairs.tsv",
col_names = c("Genome", "Gene", "Plasmid")
)
heatmap_data <- pairs %>%
count(Gene, Plasmid) %>%
filter(n >= 2)
ggplot(heatmap_data, aes(Plasmid, Gene, fill = n)) +
geom_tile(color = "grey80", linewidth = 0.3) +
scale_fill_gradient(
low = "grey85",
high = "firebrick",
name = "Co-occurrence\n(count)"
) +
labs(
title = "Plasmid–AMR Gene Co-occurrence",
x = "Plasmid replicon type",
y = "Resistance gene"
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.line = element_line(color = "black", linewidth = 0.6),
panel.grid = element_blank()
)
# set working directory
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")
library(tidyverse)
# load gene–plasmid pairs
pairs <- read_tsv(
"gene_plasmid_pairs.tsv",
col_names = c("Genome", "Gene", "Plasmid")
)
# calculate plasmid promiscuity
plasmid_promiscuity <- pairs %>%
distinct(Gene, Plasmid) %>%     # unique gene–plasmid links
count(Plasmid)                  # number of genes per plasmid
# plot plasmid promiscuity
ggplot(plasmid_promiscuity,
aes(x = n, y = reorder(Plasmid, n))) +
geom_segment(aes(x = 0, xend = n, yend = Plasmid),
color = "grey70") +
geom_point(size = 4, color = "steelblue") +
labs(
title = "Plasmid Promiscuity in AMR Gene Carriage",
x = "Number of unique resistance genes",
y = "Plasmid replicon type"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
panel.grid.minor = element_blank()
)
ggplot(plasmid_promiscuity, aes(x = "", y = n)) +
geom_violin(fill = "grey80", color = "black") +
geom_jitter(width = 0.05, size = 2, color = "steelblue") +
labs(
title = "Distribution of Plasmid Promiscuity",
x = "",
y = "Number of unique resistance genes"
) +
theme_minimal(base_size = 12) +
theme(plot.title = element_text(face = "bold"))
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")
library(tidyverse)
pairs <- read_tsv(
"gene_plasmid_pairs.tsv",
col_names = c("Genome", "Gene", "Plasmid")
)
gene_breadth <- pairs %>%
distinct(Gene, Plasmid) %>%
count(Gene)
ggplot(gene_breadth, aes(x = n)) +
geom_dotplot(binwidth = 0.5, fill = "steelblue", color = "black") +
labs(
title = "Breadth of Plasmid Association per Resistance Gene",
x = "Number of plasmid types",
y = "Gene count"
) +
theme_minimal(base_size = 12) +
theme(plot.title = element_text(face = "bold"))
plasmid_promiscuity <- pairs %>%
distinct(Gene, Plasmid) %>%
count(Plasmid) %>%
arrange(desc(n)) %>%
mutate(cumulative = cumsum(n) / sum(n),
rank = row_number())
ggplot(plasmid_promiscuity, aes(rank, cumulative)) +
geom_line(linewidth = 1, color = "firebrick") +
geom_point(size = 3, color = "firebrick") +
scale_y_continuous(labels = scales::percent) +
labs(
title = "Cumulative AMR Gene Diversity Across Plasmids",
x = "Plasmid replicon (ranked)",
y = "Cumulative proportion of AMR genes"
) +
theme_minimal(base_size = 12) +
theme(plot.title = element_text(face = "bold"))
# set working directory
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")
library(tidyverse)
# load gene–plasmid pairs
pairs <- read_tsv(
"gene_plasmid_pairs.tsv",
col_names = c("Genome", "Gene", "Plasmid")
)
# calculate plasmid promiscuity
plasmid_promiscuity <- pairs %>%
distinct(Gene, Plasmid) %>%     # unique gene–plasmid links
count(Plasmid)                  # number of genes per plasmid
# plot plasmid promiscuity
ggplot(plasmid_promiscuity,
aes(x = n, y = reorder(Plasmid, n))) +
geom_segment(aes(x = 0, xend = n, yend = Plasmid),
color = "grey70") +
geom_point(size = 4, color = "steelblue") +
labs(
title = "Plasmid Promiscuity in AMR Gene Carriage",
x = "Number of unique resistance genes",
y = "Plasmid replicon type"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
panel.grid.minor = element_blank()
)
# set working directory
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")
library(tidyverse)
# load gene–plasmid pairs
pairs <- read_tsv(
"gene_plasmid_pairs.tsv",
col_names = c("Genome", "Gene", "Plasmid")
)
# calculate gene promiscuity
gene_promiscuity <- pairs %>%
distinct(Gene, Plasmid) %>%   # unique associations
count(Gene)                   # number of plasmid types per gene
# plot gene promiscuity
ggplot(gene_promiscuity,
aes(x = n, y = reorder(Gene, n))) +
geom_segment(aes(x = 0, xend = n, yend = Gene),
color = "grey70") +
geom_point(size = 4, color = "firebrick") +
labs(
title = "Plasmid Breadth of Resistance Genes",
x = "Number of plasmid replicon types",
y = "Resistance gene"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
panel.grid.minor = element_blank()
)
gene_promiscuity_top <- gene_promiscuity %>%
slice_max(n, n = 15)
ggplot(gene_promiscuity_top,
aes(x = n, y = reorder(Gene, n))) +
geom_segment(aes(x = 0, xend = n, yend = Gene),
color = "grey70") +
geom_point(size = 3, color = "firebrick") +
labs(
title = "Top Resistance Genes by Plasmid Breadth",
x = "Number of plasmid replicon types",
y = "Resistance gene"
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(face = "bold"),
panel.grid.minor = element_blank()
)
# set working directory
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")
library(tidyverse)
# load gene–plasmid pairs
pairs <- read_tsv(
"gene_plasmid_pairs.tsv",
col_names = c("Genome", "Gene", "Plasmid")
)
# calculate gene–plasmid associations
gene_promiscuity <- pairs %>%
distinct(Gene, Plasmid) %>%
count(Gene)
# plot
p5 <- ggplot(gene_promiscuity,
aes(x = n, y = reorder(Gene, n))) +
geom_segment(
aes(x = 0, xend = n, yend = Gene),
color = "grey70"
) +
geom_point(size = 3, color = "firebrick") +
labs(
title = "Distribution of Resistance Genes Across Plasmid Replicon Types",
x = "Number of plasmid replicon types",
y = "Resistance gene"
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text.y = element_text(size = 7),
panel.grid.minor = element_blank()
)
# save with sufficient height to avoid label overlap
ggsave(
"plot5_gene_plasmid_distribution.png",
p5,
width = 7,
height = 10,
dpi = 300
)
# set working directory
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")
library(tidyverse)
# load gene–plasmid pairs
pairs <- read_tsv(
"gene_plasmid_pairs.tsv",
col_names = c("Genome", "Gene", "Plasmid")
)
# calculate gene–plasmid associations
gene_promiscuity <- pairs %>%
distinct(Gene, Plasmid) %>%
count(Gene)
# plot
p5 <- ggplot(gene_promiscuity,
aes(x = n, y = reorder(Gene, n))) +
geom_segment(
aes(x = 0, xend = n, yend = Gene),
color = "grey70"
) +
geom_point(size = 3, color = "firebrick") +
labs(
title = "Distribution of Resistance Genes Across Plasmid Replicon Types",
x = "Number of plasmid replicon types",
y = "Resistance gene"
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text.y = element_text(size = 7),
panel.grid.minor = element_blank()
)
# save with sufficient height to avoid label overlap
ggsave(
"plot5_gene_plasmid_distribution.png",
p5,
width = 7,
height = 10,
dpi = 300
)
# set working directory
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")
library(tidyverse)
# load gene–plasmid pairs
pairs <- read_tsv(
"gene_plasmid_pairs.tsv",
col_names = c("Genome", "Gene", "Plasmid")
)
# calculate gene–plasmid associations
gene_promiscuity <- pairs %>%
distinct(Gene, Plasmid) %>%
count(Gene)
# plot
p5 <- ggplot(gene_promiscuity,
aes(x = n, y = reorder(Gene, n))) +
geom_segment(
aes(x = 0, xend = n, yend = Gene),
color = "grey70"
) +
geom_point(size = 3, color = "firebrick") +
labs(
title = "Distribution of Resistance Genes Across Plasmid Replicon Types",
x = "Number of plasmid replicon types",
y = "Resistance gene"
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text.y = element_text(size = 7),
panel.grid.minor = element_blank()
)
# save with sufficient height to avoid label overlap
ggsave(
"plot5_gene_plasmid_distribution.png",
p5,
width = 7,
height = 10,
dpi = 300
)
# set working directory
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")
library(tidyverse)
# load gene–plasmid pairs
pairs <- read_tsv(
"gene_plasmid_pairs.tsv",
col_names = c("Genome", "Gene", "Plasmid")
)
# calculate gene–plasmid associations
gene_promiscuity <- pairs %>%
distinct(Gene, Plasmid) %>%
count(Gene)
# plot
p5 <- ggplot(gene_promiscuity,
aes(x = n, y = reorder(Gene, n))) +
geom_segment(
aes(x = 0, xend = n, yend = Gene),
color = "grey70"
) +
geom_point(size = 3, color = "firebrick") +
labs(
title = "Distribution of Resistance Genes Across Plasmid Replicon Types",
x = "Number of plasmid replicon types",
y = "Resistance gene"
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text.y = element_text(size = 7),
panel.grid.minor = element_blank()
)
# save with sufficient height to avoid label overlap
ggsave(
"plot5_gene_plasmid_distribution.png",
p5,
width = 7,
height = 10,
dpi = 300
)
p5 <- ggplot(gene_promiscuity,
aes(x = n, y = reorder(Gene, n))) +
geom_segment(
aes(x = 0, xend = n, yend = Gene),
color = "grey70"
) +
geom_point(size = 3, color = "firebrick") +
labs(
title = "Distribution of Resistance Genes Across Plasmid Replicon Types",
x = "Number of plasmid replicon types",
y = "Resistance gene"
) +
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(face = "bold"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.text.y = element_text(size = 7),
panel.grid.minor = element_blank()
)
print(p5)
