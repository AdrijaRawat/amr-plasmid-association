# Set working directory
setwd("//wsl$/Ubuntu/home/nav/amr-mini-project/results")

# Load library
library(tidyverse)

# Load plasmid data
plasmids <- read_tsv(
  "plasmids.tsv",
  col_names = c("Genome", "Plasmid")
)

# Count plasmid frequencies
plasmid_count <- plasmids %>%
  count(Plasmid) %>%
  arrange(desc(n)) %>%
  mutate(
    cumulative = cumsum(n) / sum(n),
    rank = row_number()
  )

# Plot cumulative contribution
ggplot(plasmid_count, aes(x = rank, y = cumulative)) +
  geom_line(color = "steelblue", linewidth = 1) +
  geom_point(size = 3, color = "steelblue") +
  scale_y_continuous(labels = scales::percent) +
  scale_x_continuous(
    breaks = plasmid_count$rank,
    labels = plasmid_count$Plasmid
  ) +
  labs(
    title = "Cumulative Contribution of Plasmid Replicons",
    x = "Plasmid Replicon (ranked by frequency)",
    y = "Cumulative Proportion of Replicons"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

